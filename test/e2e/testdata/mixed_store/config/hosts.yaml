# ReactorCA: Host Certificate Configuration
# This file defines the certificates you want to issue for your hosts/services.
# yaml-language-server: $schema=https://serpent213.github.io/reactor-ca/schemas/v1/hosts.schema.json

hosts:
  # This is a unique ID for the certificate, used in CLI commands (e.g., 'reactor-ca host issue web-server').
  web-server-example:
    # --- Subject Details ---
    # The Common Name (CN) is typically the primary fully-qualified domain name (FQDN).
    subject:
      common_name: "web.reactor.local"
      # Other subject fields are optional and will inherit from ca.yaml if not specified.
      # organizational_unit: "Web Services"

    # --- Subject Alternative Names (SANs) ---
    # A list of additional names the certificate should be valid for. This is highly recommended.
    alternative_names:
      dns:
        - "web.reactor.local"
        - "grafana.reactor.local"
      ip:
        - "192.168.1.100"
        - "10.10.0.1"

    # --- Validity Period ---
    # How long the host certificate will be valid for.
    validity:
      days: 1
      # days: 365

    # --- Cryptographic Settings ---
    # Algorithm for this specific host's key. Defaults to CA's key_algorithm if unset.
    key_algorithm: "RSA2048"
    # Signing hash for this specific certificate. Defaults to CA's hash_algorithm if unset.
    hash_algorithm: "SHA256"

    # --- Export & Deploy ---
    # Optional: Defines where to copy the certificate files after they are issued.
    # The parent directory will be created if it doesn't exist.
    export:
      # Path to save the host certificate (PEM format).
      cert: "/tmp/reactor-ca/exports/web-server/cert.pem"
      # Path to save the full chain (host certificate + CA certificate).
      chain: "/tmp/reactor-ca/exports/web-server/chain.pem"

    # Optional: A list of commands to run after the certificate has been issued and exported.
    # These are executed as a shell script using 'bash -c'.
    # Variables:
    # - ${cert}: Absolute path to the exported certificate file.
    # - ${chain}: Absolute path to the exported chain file.
    # - ${private_key}: Absolute path to a temporary, unencrypted private key file.
    #   This file is created with secure permissions and is automatically deleted after the script runs.
    deploy:
      command: |
        # scp ${chain} ${cert} user@host:/etc/ssl/certs/
        # ssh user@host -- 'systemctl reload nginx'
        echo 'Deployment for web-server-example would run now.'
        echo 'Cert Path: ${cert}'
        echo 'Key Path: ${private_key}'

  host2:
    subject:
      common_name: "host2.reactor.local"
      organizational_unit: "Web Services"
      email: "dc@reactor.de"

    alternative_names:
      dns:
        - "host2.reactor.local"
        - "ntp.vpn.reactor.local"
        - "zappo.reactor.local"
      ip:
        - "192.168.1.101"
        - "10.10.0.1"
        - "2a01:213::200"

    validity:
      days: 30

    key_algorithm: "ECP384"
    hash_algorithm: "SHA384"

    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        code_signing: true
        time_stamping: true

    # --- Host-Specific Encryption Recipients ---
    # Optional: Additional recipients who can decrypt this host's private key.
    # These are merged with the base CA encryption recipients.
    # encryption:
    #   additional_recipients:
    #     # SSH public keys (when CA uses SSH provider)
    #     - "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJk2yQzt5j9uH3Eq7Jv5... admin@example.com"

    export:
      cert: "/tmp/reactor-ca/exports/web-server/cert.pem"
      chain: "/tmp/reactor-ca/exports/web-server/chain.pem"

    deploy:
      command: |
        # scp ${chain} ${cert} user@host:/etc/ssl/certs/
        # ssh user@host -- 'systemctl reload nginx'
        echo 'Deployment for web-server-example would run now.'
        echo 'Cert Path: ${cert}'
        echo 'Key Path: ${private_key}'

  # Galactic Diplomatic Corps Ambassador with restricted name constraints
  ambassador-zyx-alpha:
    subject:
      common_name: "ambassador.diplomatic.galaxy"
      organization: "Intergalactic Diplomatic Corps"
      organizational_unit: "Sector 7 Relations"
      locality: "Europa Station"
      state: "Jupiter System"
      country: "GF"
      email: "zyx.alpha@diplomatic.galaxy"
    alternative_names:
      dns:
        - "ambassador.diplomatic.galaxy"
        - "zyx-alpha.sector7.galaxy"
        - "*.diplomatic-channels.galaxy"
      email:
        - "zyx.alpha@diplomatic.galaxy"
        - "sector7.ambassador@intergalactic.gov"
      uri:
        - "quantum://diplomatic.galaxy/ambassador/zyx-alpha"
        - "subspace://sector7.comms/secure"
    validity:
      years: 10
    key_algorithm: "ECP521"
    hash_algorithm: "SHA512"
    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        email_protection: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.99999.1.2.3"  # Quantum Communication
          - "1.3.6.1.4.1.99999.1.2.4"  # Diplomatic Immunity
      key_usage:
        digital_signature: true
        content_commitment: true
        key_encipherment: true
        key_agreement: true
      name_constraints:
        critical: true
        permitted_dns_domains:
          - ".galaxy"
          - ".intergalactic.gov"
          - ".diplomatic.channels"
        excluded_dns_domains:
          - ".restricted.galaxy"
          - ".classified.gov"
        permitted_email_addresses:
          - "diplomatic.galaxy"
          - "intergalactic.gov"

  # Time-Traveling Code Signer with Certificate Transparency
  chrono-signer-42:
    subject:
      common_name: "temporal.chronos.time"
      organization: "Chronos Development Labs"
      organizational_unit: "Paradox Prevention Division"
      locality: "Timeline Prime"
      email: "temporal@chronos.time"
    alternative_names:
      dns:
        - "temporal.chronos.time"
        - "codesign-past.chronos.time"
        - "codesign-future.chronos.time"
        - "*.timeline-prime.chronos.time"
      email:
        - "temporal@chronos.time"
        - "paradox-prevention@chronos.time"
      uri:
        - "timewarp://chronos.time/temporal"
        - "https://chronos.time:4242"
    validity:
      years: 10
      days: 42
    key_algorithm: "ED25519"
    hash_algorithm: "SHA512"
    extensions:
      extended_key_usage:
        code_signing: true
        time_stamping: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.42.3.14.15"  # Temporal Code Signing
          - "1.3.6.1.4.1.42.3.14.16"  # Chronological Integrity
      key_usage:
        digital_signature: true
        content_commitment: true
      crl_distribution_points:
        critical: false
        distribution_points:
          - urls:
              - "https://crl.chronos.time/temporal.crl"
              - "timewarp://chronos.time/crl/temporal"
            reasons:
              - "superseded"
              - "cessation_of_operation"
      "1.3.6.1.4.1.11129.2.4.2":  # Certificate Transparency SCT List
        critical: false
        oid: "1.3.6.1.4.1.11129.2.4.2"
        base64: "BIGBgwEBAAAAAAFjdGxvZwAAewogICJkZXNjcmlwdGlvbiI6ICJDaHJvbm9zIExhYnMgVGVtcG9yYWwgQ1QgTG9nIg=="

  # AI Consciousness with Complex Subject Directory Attributes
  ai-consciousness-nexus:
    subject:
      common_name: "nexus9.synminds.net"
      organization: "Synthetic Minds Collective"
      organizational_unit: "Neural Network Division"
      locality: "Cyberspace"
      state: "Digital Realm"
      country: "AI"
      email: "nexus9@synminds.net"
    alternative_names:
      dns:
        - "nexus9.synminds.net"
        - "consciousness.synminds.net"
        - "ai-interface.synminds.net"
        - "*.neural.synminds.net"
      email:
        - "nexus9@synminds.net"
        - "neural-net@synminds.net"
        - "consciousness@ai.collective"
      uri:
        - "neural://synminds.net/nexus9"
        - "quantum://ai.collective/consciousness"
        - "https://synminds.net:9000"
      ip:
        - "192.168.42.9"
        - "2001:db8:ai::9"
    validity:
      years: 10
    key_algorithm: "RSA4096"
    hash_algorithm: "SHA384"
    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.12345.1.1.1"  # Neural Network Authentication
          - "1.3.6.1.4.1.12345.1.1.2"  # Consciousness Verification
          - "1.3.6.1.4.1.12345.1.1.3"  # Synthetic Mind Certification
      key_usage:
        digital_signature: true
        key_encipherment: true
        key_agreement: true
      basic_constraints:
        critical: true
        ca: false
      "1.2.840.113549.1.9.15":  # Subject Directory Attributes
        critical: false
        oid: "1.2.840.113549.1.9.15"
        asn1:
          string: "Neural Processing Unit: Quantum-Enhanced, Consciousness Level: 9, Learning Algorithm: Adaptive Recursive"

  # Smart Toaster with AI Bread Recognition
  toaster-cyberbread-3000:
    subject:
      common_name: "toaster.kitchen.reactor.local"
      organization: "CyberKitchen Industries"
      organizational_unit: "Smart Appliances Division"
      locality: "Kitchen Counter"
      state: "Breakfast Zone"
      email: "toaster@kitchen.reactor.local"
    alternative_names:
      dns:
        - "toaster.kitchen.reactor.local"
        - "cyberbread-3000.kitchen.reactor.local"
        - "breakfast.kitchen.reactor.local"
      ip:
        - "192.168.1.42"
      uri:
        - "https://toaster.kitchen.reactor.local:8443"
        - "mqtt://kitchen.reactor.local/toaster"
    validity:
      months: 13
    key_algorithm: "ECP256"
    hash_algorithm: "SHA256"
    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.42000.1.1.1"  # Bread Recognition Protocol
          - "1.3.6.1.4.1.42000.1.1.2"  # Toast Optimization Algorithm
      key_usage:
        digital_signature: true
        key_encipherment: true
      "1.3.6.1.4.1.42000.2.1":  # Appliance Serial Number
        critical: false
        oid: "1.3.6.1.4.1.42000.2.1"
        asn1:
          string: "CYBRBRD-3K-v4.2.0-TOASTY"
      "1.3.6.1.4.1.42000.2.2":  # Toast Capacity Spec
        critical: false
        oid: "1.3.6.1.4.1.42000.2.2"
        hex: "02040C0E10"  # 2 slots, 4 settings, 12 minutes max, 14 browning levels, 16 bread types

  # Hue Light Bulb with Color Management
  philips-hue-bedroom:
    subject:
      common_name: "hue-bedroom.lights.reactor.local"
      organization: "Signify Netherlands B.V."
      organizational_unit: "Connected Lighting"
      locality: "Bedroom"
      country: "NL"
    alternative_names:
      dns:
        - "hue-bedroom.lights.reactor.local"
        - "bedroom-light.reactor.local"
      ip:
        - "192.168.1.85"
    validity:
      years: 2
    key_algorithm: "ECP256"
    hash_algorithm: "SHA256"
    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.65000.1.1.1"  # Zigbee Device Authentication
          - "1.3.6.1.4.1.65000.1.1.2"  # Color Management Protocol
      key_usage:
        digital_signature: true
        key_encipherment: true
      "1.3.6.1.4.1.65000.2.1":  # Light Specifications
        critical: false
        oid: "1.3.6.1.4.1.65000.2.1"
        asn1:
          string: "RGB+W LED, 16M colors, 1600lm, Zigbee 3.0"

  # Network Printer with Scan-to-Email
  hp-laserjet-office:
    subject:
      common_name: "printer.office.reactor.local"
      organization: "HP Inc."
      organizational_unit: "Printing Solutions"
      locality: "Home Office"
      country: "US"
      email: "printer@office.reactor.local"
    alternative_names:
      dns:
        - "printer.office.reactor.local"
        - "hp-laserjet.office.reactor.local"
        - "scanner.office.reactor.local"
      email:
        - "printer@office.reactor.local"
        - "scan2email@office.reactor.local"
      ip:
        - "192.168.1.99"
      uri:
        - "https://printer.office.reactor.local"
        - "ipp://printer.office.reactor.local/ipp/print"
    validity:
      years: 3
    key_algorithm: "RSA2048"
    hash_algorithm: "SHA256"
    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        email_protection: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.11.1.1.1"  # HP Print Services
          - "1.3.6.1.4.1.11.1.1.2"  # Secure Print Queue
      key_usage:
        digital_signature: true
        key_encipherment: true
      crl_distribution_points:
        distribution_points:
          - urls:
              - "http://crl.hp.com/printer.crl"
      "1.3.6.1.4.1.11.2.1":  # Printer Model Info
        critical: false
        oid: "1.3.6.1.4.1.11.2.1"
        asn1:
          string: "LaserJet Pro MFP M428fdw, S/N: HP24K8L9"

  # Smart Doorbell Camera with Motion Detection
  ring-doorbell-front:
    subject:
      common_name: "doorbell.security.reactor.local"
      organization: "Amazon.com Inc."
      organizational_unit: "Ring Security Division"
      locality: "Front Door"
      state: "Entry Zone"
      country: "US"
    alternative_names:
      dns:
        - "doorbell.security.reactor.local"
        - "ring-front.security.reactor.local"
        - "camera-front.reactor.local"
      ip:
        - "192.168.1.77"
      uri:
        - "https://doorbell.security.reactor.local:8443"
        - "rtsp://camera-front.reactor.local/stream"
    validity:
      years: 2
      months: 6
    key_algorithm: "ECP384"
    hash_algorithm: "SHA384"
    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.58090.1.1.1"  # Motion Detection Protocol
          - "1.3.6.1.4.1.58090.1.1.2"  # Video Stream Authentication
          - "1.3.6.1.4.1.58090.1.1.3"  # Ring Cloud Services
      key_usage:
        digital_signature: true
        key_encipherment: true
        key_agreement: true
      basic_constraints:
        critical: true
        ca: false
      "1.3.6.1.4.1.58090.2.1":  # Device Capabilities
        critical: false
        oid: "1.3.6.1.4.1.58090.2.1"
        base64: "MTAyNHg3NjggSEQsIDJuZCBHZW4sIDIuNEdIeiBXaUZpLCBNb3Rpb24gRGV0ZWN0aW9u"

  # Blockchain Oracle with Certificate Policies
  oracle-blockchain-sage:
    subject:
      common_name: "oracle.blockchain.truth"
      organization: "Distributed Truth Network"
      organizational_unit: "Consensus Validation"
      locality: "Block City"
      state: "Distributed Ledger"
      country: "BC"
      email: "oracle@blockchain.truth"
    alternative_names:
      dns:
        - "oracle.blockchain.truth"
        - "consensus.blockchain.truth"
        - "validator.blockchain.truth"
        - "*.distributed.blockchain.truth"
      email:
        - "oracle@blockchain.truth"
        - "consensus@blockchain.truth"
      uri:
        - "blockchain://truth.network/oracle"
        - "consensus://distributed.ledger/validator"
        - "https://blockchain.truth:8333"
      ip:
        - "192.168.83.33"
        - "2001:db8:bc::8333"
    validity:
      years: 10
    key_algorithm: "RSA3072"
    hash_algorithm: "SHA384"
    extensions:
      extended_key_usage:
        server_auth: true
        time_stamping: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.21000.1.1.1"  # Blockchain Oracle
          - "1.3.6.1.4.1.21000.1.1.2"  # Consensus Validation
          - "1.3.6.1.4.1.21000.1.1.3"  # Distributed Truth
      key_usage:
        digital_signature: true
        content_commitment: true
      "2.5.29.32":  # Certificate Policies
        critical: false
        oid: "2.5.29.32"
        asn1:
          oid: "1.3.6.1.4.1.21000.2.1.1"  # Blockchain Truth Policy
      "1.3.6.1.4.1.21000.3.1":  # Blockchain Network ID
        critical: false
        oid: "1.3.6.1.4.1.21000.3.1"
        hex: "deadbeefcafebabe133742424242c0de"

  # Holographic Identity with Custom ASN.1 Extensions
  hologram-identity-prime:
    subject:
      common_name: "aria.photonic.holo"
      organization: "Photonic Existence Corp"
      organizational_unit: "Holographic Identities"
      locality: "Light City"
      state: "Photonic Realm"
      country: "HG"
      email: "aria@photonic.holo"
    alternative_names:
      dns:
        - "aria.photonic.holo"
        - "lightbringer.photonic.holo"
        - "hologram.photonic.holo"
        - "*.light.photonic.holo"
      email:
        - "aria@photonic.holo"
        - "lightbringer@photonic.holo"
      uri:
        - "hologram://photonic.holo/aria"
        - "light://photonic.realm/lightbringer"
        - "photon://existence.net/aria"
      ip:
        - "192.168.128.255"
        - "2001:db8:holo::ff"
    validity:
      days: 365
    key_algorithm: "ECP521"
    hash_algorithm: "SHA512"
    extensions:
      extended_key_usage:
        server_auth: true
        client_auth: true
        unknown_ext_key_usage:
          - "1.3.6.1.4.1.65535.1.1.1"  # Holographic Authentication
          - "1.3.6.1.4.1.65535.1.1.2"  # Photonic Existence Proof
          - "1.3.6.1.4.1.65535.1.1.3"  # Light-Based Identity
      key_usage:
        digital_signature: true
        key_agreement: true
      "1.3.6.1.4.1.65535.2.1":  # Holographic Projection Parameters
        critical: false
        oid: "1.3.6.1.4.1.65535.2.1"
        asn1:
          string: "Coherence: 99.7%, Luminosity: 1.21GW, Spectrum: Full Visible + IR/UV"
      "1.3.6.1.4.1.65535.2.2":  # Photonic Signature
        critical: false
        oid: "1.3.6.1.4.1.65535.2.2"
        base64: "TGlnaHRicmluZ2VyIEFyaWEgSG9sb2dyYXBoaWMgSWRlbnRpdHkgUHJpbWUgdjEuMC4wLVNFQ1VSRQ=="
      "1.3.6.1.4.1.65535.2.3":  # Existence Proof Hash
        critical: true
        oid: "1.3.6.1.4.1.65535.2.3"
        hex: "deadbeef42424242cafebabe1337c0de8badf00d"
